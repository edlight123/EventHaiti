<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Test Events</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #0F766E;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        button {
            background: #0F766E;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        button:hover {
            background: #0d6862;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        #output {
            margin-top: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .success { color: #059669; }
        .error { color: #dc2626; }
        .info { color: #0284c7; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Create Test Events</h1>
        <p class="subtitle">This will create 7 sample events for testing purposes under info@edlight.org</p>
        
        <button id="createBtn" onclick="createTestEvents()">Create Test Events</button>
        
        <div id="output"></div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, query, where, getDocs, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase configuration - replace with your actual config from .env.local
        const firebaseConfig = {
            apiKey: "AIzaSyBR5nV8rX2J7kZ9zQ8wX5nY4mP6jK7lL8M",
            authDomain: "event-haiti.firebaseapp.com",
            projectId: "event-haiti",
            storageBucket: "event-haiti.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abc123def456"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.createTestEvents = async function() {
            const btn = document.getElementById('createBtn');
            const output = document.getElementById('output');
            
            btn.disabled = true;
            output.innerHTML = '<span class="info">Starting event creation...</span>\n';

            try {
                // First, authenticate as the user (you'll need to provide credentials)
                output.innerHTML += '<span class="info">Note: You need to be logged in as info@edlight.org</span>\n';
                output.innerHTML += '<span class="info">Please sign in through the EventHaiti website first, then run this script.</span>\n\n';

                // Check if user is signed in
                const user = auth.currentUser;
                if (!user) {
                    output.innerHTML += '<span class="error">❌ No user signed in. Please:</span>\n';
                    output.innerHTML += '<span class="error">1. Go to http://localhost:3000/auth/login</span>\n';
                    output.innerHTML += '<span class="error">2. Sign in as info@edlight.org</span>\n';
                    output.innerHTML += '<span class="error">3. Come back and run this script again</span>\n';
                    btn.disabled = false;
                    return;
                }

                output.innerHTML += `<span class="success">✓ Signed in as: ${user.email}</span>\n\n`;

                // Get user document
                const usersQuery = query(collection(db, 'users'), where('email', '==', user.email));
                const userSnapshot = await getDocs(usersQuery);
                
                if (userSnapshot.empty) {
                    throw new Error('User document not found');
                }

                const userId = userSnapshot.docs[0].id;
                output.innerHTML += `<span class="success">✓ Found user ID: ${userId}</span>\n\n`;

                const events = [
                    {
                        title: 'Tech Innovation Summit 2025',
                        description: 'Join Haiti\'s premier technology conference featuring keynote speakers, workshops, and networking opportunities. Explore the latest innovations in AI, blockchain, and digital transformation shaping Haiti\'s tech landscape.',
                        category: 'Technology',
                        location: 'Port-au-Prince Convention Center',
                        address: '123 Tech Avenue, Pétion-Ville, Port-au-Prince',
                        date: new Date('2025-02-15T09:00:00'),
                        price: 2500,
                        currency: 'HTG',
                        totalTickets: 500,
                        imageUrl: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=800',
                        isVirtual: false,
                        isFeatured: true
                    },
                    {
                        title: 'Haiti Jazz & Arts Festival',
                        description: 'Experience the vibrant sounds of Haitian jazz and international artists in this week-long celebration of music and culture. Features live performances, art exhibitions, and culinary experiences.',
                        category: 'Music',
                        location: 'Jacmel Waterfront',
                        address: 'Beach Road, Jacmel',
                        date: new Date('2025-03-20T18:00:00'),
                        price: 1500,
                        currency: 'HTG',
                        totalTickets: 1000,
                        imageUrl: 'https://images.unsplash.com/photo-1511735111819-9a3f7709049c?w=800',
                        isVirtual: false,
                        isFeatured: true
                    },
                    {
                        title: 'Entrepreneurship Workshop Series',
                        description: 'A comprehensive 6-week program designed for aspiring entrepreneurs. Learn business fundamentals, financial planning, marketing strategies, and pitch preparation from successful Haitian business leaders.',
                        category: 'Education',
                        location: 'Business Innovation Hub',
                        address: '45 Commerce Street, Port-au-Prince',
                        date: new Date('2025-02-08T14:00:00'),
                        price: 3000,
                        currency: 'HTG',
                        totalTickets: 150,
                        imageUrl: 'https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=800',
                        isVirtual: false,
                        isFeatured: false
                    },
                    {
                        title: 'Haitian Cuisine Masterclass',
                        description: 'Learn to prepare authentic Haitian dishes from renowned Chef Marie-Louise. This hands-on cooking class covers traditional recipes, local ingredients, and modern twists on classic favorites.',
                        category: 'Food & Drink',
                        location: 'Culinary Arts Studio',
                        address: '78 Gourmet Lane, Pétion-Ville',
                        date: new Date('2025-02-22T10:00:00'),
                        price: 1800,
                        currency: 'HTG',
                        totalTickets: 40,
                        imageUrl: 'https://images.unsplash.com/photo-1556910103-1c02745aae4d?w=800',
                        isVirtual: false,
                        isFeatured: false
                    },
                    {
                        title: 'Charity 5K Run for Education',
                        description: 'Run for a cause! Support education initiatives across Haiti while staying fit. All proceeds go toward building libraries and providing school supplies in underserved communities.',
                        category: 'Sports',
                        location: 'Champ de Mars',
                        address: 'Champ de Mars, Port-au-Prince',
                        date: new Date('2025-03-10T06:00:00'),
                        price: 500,
                        currency: 'HTG',
                        totalTickets: 2000,
                        imageUrl: 'https://images.unsplash.com/photo-1452626038306-9aae5e071dd3?w=800',
                        isVirtual: false,
                        isFeatured: true
                    },
                    {
                        title: 'Art Gallery Opening: Haitian Masters',
                        description: 'Grand opening of a new exhibition showcasing works by Haiti\'s most celebrated contemporary artists. Enjoy wine, light refreshments, and meet the artists in this elegant evening event.',
                        category: 'Arts & Culture',
                        location: 'Musée d\'Art Haïtien',
                        address: '201 Art Boulevard, Port-au-Prince',
                        date: new Date('2025-02-28T19:00:00'),
                        price: 0,
                        currency: 'HTG',
                        totalTickets: 300,
                        imageUrl: 'https://images.unsplash.com/photo-1531243269054-5ebf6f34081e?w=800',
                        isVirtual: false,
                        isFeatured: true
                    },
                    {
                        title: 'Digital Marketing Bootcamp',
                        description: 'Master the fundamentals of digital marketing including social media strategy, SEO, content creation, and analytics. Perfect for small business owners and marketing professionals.',
                        category: 'Business',
                        location: 'Online via Zoom',
                        address: 'Virtual Event',
                        date: new Date('2025-02-18T15:00:00'),
                        price: 2000,
                        currency: 'HTG',
                        totalTickets: 500,
                        imageUrl: 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800',
                        isVirtual: true,
                        isFeatured: false
                    }
                ];

                let successCount = 0;
                let errorCount = 0;

                for (const event of events) {
                    try {
                        const eventData = {
                            ...event,
                            organizerId: userId,
                            status: 'published',
                            ticketsSold: 0,
                            createdAt: serverTimestamp(),
                            updatedAt: serverTimestamp()
                        };

                        const docRef = await addDoc(collection(db, 'events'), eventData);
                        output.innerHTML += `<span class="success">✓ Created: ${event.title} (ID: ${docRef.id})</span>\n`;
                        successCount++;
                    } catch (error) {
                        output.innerHTML += `<span class="error">✗ Failed: ${event.title} - ${error.message}</span>\n`;
                        errorCount++;
                    }
                }

                output.innerHTML += `\n<span class="success">━━━━━━━━━━━━━━━━━━━━━━━━━━</span>\n`;
                output.innerHTML += `<span class="success">✓ Successfully created ${successCount} events</span>\n`;
                if (errorCount > 0) {
                    output.innerHTML += `<span class="error">✗ Failed to create ${errorCount} events</span>\n`;
                }
                output.innerHTML += `\n<span class="info">You can now view them at: http://localhost:3000/discover</span>\n`;

            } catch (error) {
                output.innerHTML += `\n<span class="error">❌ Error: ${error.message}</span>\n`;
                console.error(error);
            } finally {
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>
